<p-toast position="top-right" styleClass="app-toast"></p-toast>
<div class="w-full text-white">
  <div class="backdrop-blur-lg bg-white/10 border border-white/20 rounded-xl shadow-2xl overflow-hidden">
    <div class="p-4 border-b border-white/10">
      <div class="flex items-start justify-between gap-4">
        <div class="flex-1">
          <h1 class="text-xl font-bold bg-gradient-to-r from-pink-500 via-purple-400 to-blue-500 bg-clip-text text-transparent">
            Create New Issue
          </h1>
          <p class="text-gray-300 text-xs mt-1">Fill in the details to create a new issue</p>
        </div>

        <div class="flex items-center gap-2 flex-shrink-0">
          

          <button 
            type="button"
            class="bg-gradient-to-r from-pink-600 via-purple-700 to-blue-800 text-white px-4 py-2 rounded-lg shadow-lg hover:opacity-90 transition font-semibold text-sm flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed"
            (click)="onSubmit()"
            [disabled]="loading || !title || !description || !estimatedTime || !dueDate || (currentUser?.role === 'admin' && !assignedTo)">
            <i class="pi pi-check text-xs"></i> Save & Close
          </button>

          <div class="relative">
            <button 
              type="button"
              class="px-2 py-1.5 rounded-lg bg-white/5 hover:bg-white/10 border border-white/10 transition flex items-center justify-center"
              (click)="toggleMenu()">
              <i class="pi pi-ellipsis-v text-sm"></i>
            </button>
            <div *ngIf="showMenu" class="absolute right-0 top-full mt-1 z-50 backdrop-blur-lg bg-gray-900/95 border border-white/20 rounded-lg shadow-xl overflow-hidden min-w-[140px]">
              <button 
                type="button"
                class="w-full px-3 py-2 text-left text-sm hover:bg-white/10 transition flex items-center gap-2 text-gray-300"
                (click)="resetForm()">
                <i class="pi pi-refresh text-xs"></i> Reset Form
              </button>
            </div>
          </div>

          <button 
            type="button"
            class="px-2 py-1.5 rounded-lg bg-white/5 hover:bg-white/10 border border-white/10 transition flex items-center justify-center"
            (click)="closeModal()">
            <i class="pi pi-times text-sm"></i>
          </button>
        </div>
      </div>
    </div>

    <div class="p-4">
      

      <form class="space-y-4" novalidate>
        <div class="grid grid-cols-1 lg:grid-cols-[70fr_30fr] gap-4">
          
          <div class="space-y-4">
            <div>
              <label class="block text-xs font-semibold text-gray-200 mb-1">
                Issue Title <span class="text-pink-400">*</span>
              </label>
              <input
                pInputText
                [(ngModel)]="title"
                name="title"
                placeholder="Enter a clear, concise issue title"
                class="w-full text-sm"
                [disabled]="loading"
                required
              />
            </div>

            <div>
              <label class="block text-xs font-semibold text-gray-200 mb-1">
                Description <span class="text-pink-400">*</span>
              </label>
              <textarea
                pInputTextarea
                [(ngModel)]="description"
                name="description"
                placeholder="Provide detailed description of the issue"
                rows="8"
                class="w-full text-sm"
                [disabled]="loading"
                required
              ></textarea>
            </div>
          </div>

          
          <div class="space-y-4">
            <div>
              <label class="block text-xs font-semibold text-gray-200 mb-1">
                Estimated Time (Hours) <span class="text-pink-400">*</span>
              </label>
              <p-inputNumber
                [(ngModel)]="estimatedTime"
                name="estimatedTime"
                [min]="1"
                [max]="1000"
                placeholder="e.g. 8"
                class="w-full text-sm"
                [disabled]="loading"
                required
              ></p-inputNumber>
            </div>

            <div>
              <label class="block text-xs font-semibold text-gray-200 mb-1">
                Due Date <span class="text-pink-400">*</span>
              </label>
              <p-calendar
                [(ngModel)]="dueDate"
                name="dueDate"
                dateFormat="dd/mm/yy"
                [showIcon]="true"
                placeholder="Select due date"
                class="w-full text-sm"
                [minDate]="minDueDate"
                [disabled]="loading"
                required
              ></p-calendar>
            </div>

            <div *ngIf="currentUser?.role === 'admin'">
              <label class="block text-xs font-semibold text-gray-200 mb-1">
                Assign To <span class="text-pink-400">*</span>
              </label>
              <p-dropdown
                [(ngModel)]="assignedTo"
                name="assignedTo"
                [options]="userOptions"
                optionLabel="label"
                optionValue="value"
                placeholder="Select user"
                class="w-full text-sm"
                [disabled]="loading"
                required
              ></p-dropdown>
            </div>

            <div class="bg-white/10 border border-white/20 rounded-lg p-3 flex gap-2 items-start">
              <i class="pi pi-info-circle text-blue-400 text-sm"></i>
              <div>
                <p class="font-semibold text-white text-xs">Issue Details</p>
                <p class="text-[11px] text-gray-300 mt-0.5">
                  New issues start with state <span class="text-blue-300 font-medium">New</span> and 0 completed hours.
                </p>
              </div>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>